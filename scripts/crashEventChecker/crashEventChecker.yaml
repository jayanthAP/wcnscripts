$ServiceName = "Host Network Service"
$CrashEventList = @()
$MsgMatchString = "*The {0} service terminated unexpectedly*" -f $ServiceName
(Get-WinEvent -FilterHashtable @{logname = 'System'; ProviderName = 'Service Control Manager' } | Select-Object -Property TimeCreated, Id, LevelDisplayName, Message | Where-Object Message -like $MsgMatchString) `
    | ForEach-Object -Begin {} -Process {$CrashEventList += $_} -End {}


$CrashInstancesStr = ""

$i = 0
foreach ($crashEvent in $CrashEventList)
{
    if ($i -eq 0) {
        $CrashInstancesStr += $crashEvent.TimeCreated.ToString()
    } else {
        $CrashInstancesStr += ", " + $crashEvent.TimeCreated.ToString()
    }
    $i += 1
}

$(Hostname) + " : " + $CrashInstancesStr

While ($true) {
  Start-Sleep -Seconds 600
}
